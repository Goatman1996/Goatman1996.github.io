---
title: 最值，最小二乘，最值验证
icon: pen-to-square
date: 2026-01-12 00:00:00
isOriginal: true
category:
  - 数学
  - 多变量微积分
---

<!-- more -->

## 最值

与单变量微积分相同，导数可以求最值

例：求$f(x,y) = x^2 -2xy + 3y^2 + 2x - 2y$的最值

求偏导：  
$f_x = 2x - 2y + 2$  
$f_y = -2x + 6y - 2$

找最值即求偏导为0：$f_x = f_y = 0$

即解
$f_x = 2x - 2y + 2 = 0$  
$f_y = -2x + 6y - 2 = 0$

解：$x = -1,y = 0$

首先可以确定的是，$(-1,0)$为$f(x,y)$的临界点，且可以确定为局部最值点

临界点不一定是最值点，如：$f(x,y) = y^2 - x^2$马鞍函数，临界点为$(0,0)$，但是该临界点既不是最大值，也不是最小值。这种既不是最大值点也不是最小值点的点，我们称为鞍点。所以临界点分为：最大值点，最小值点，鞍点。

接下来为本例的临界值点确定类型

$$配方：f(x,y) = (x-y+1)^2 + 2y^2 -1$$

<font color=#00aa00>// 配方步骤为例题专供，可推导出来的 </font>

可以观察出：$(x-y+1)^2 \geq 0$和$2y^2 \geq 0$  
$\therefore f(x,y)\geq-1=f(-1,0)$  
$\therefore f(-1,0)$临界点为最小值点

## 最小二乘

最小二乘问题：给定一个数据集$(x_1,y_1),(x_2,y_2),\cdots,(x_n,y_n)$，求一个函数$f(x)$，使得$f(x_i)$与$y_i$的误差平方和最小。

若数据集呈线性相关，则设置$f(x) = ax + b$，则最小二乘问题转化为求解$a,b$的最值问题。

$Error(i)^2 = (y_i - f(x_i))^2 = (y_i - (ax_i - b))^2$  
总误差平方和为
$$D(a,b) = \sum_{i=1}^n Error(i)^2 = \sum_{i=1}^n (y_i - (ax_i + b))^2$$
求偏导 = 0
$$f_a = \sum_{i=1}^n 2(y_i - (ax_i +b)) \cdot -x_i = 0$$
$$f_b = \sum_{i=1}^n 2(y_i - (ax_i +b)) \cdot -1 = 0$$
等价于解线性方程组

::: details 方程组转换过程
$$
\sum_{i=1}^n x_i^2a + x_ib - x_iy_i  = 0
$$
$$
\sum_{i=1}^n x_ia + nb - y_i  = 0 
$$
:::

$$(\sum_{i=1}^n x_i^2)a + (\sum_{i=1}^n x_i)b = \sum_{i=1}^n x_i y_i $$
$$(\sum_{i=1}^n x_i)a + n b = \sum_{i=1}^n y_i
$$

## 非线性的最小二乘

摩尔定律。数据类型：$(晶体管数量, 时间)$，数据集呈指数相关。所以摩尔定律对数据集进行拟合的函数应为$y=ce^{ax}$，然而这非常的难解，所以摩尔定律先将”晶体管数量“进行对数转换，可转为线性回归问题。即拟合函数为$\ln (y)=\ln (c) + ax$

再举例，若拟合函数为二次函数，$y = ax^2 + bx + c$，则
$$D(a,b,c) = \sum_{i=1}^n (y_i - (ax_i^2 + bx_i + c))^2$$

最后将会变成解3x3线性方程组问题

<font color=##00aa00>// 线性代数课程中，亦有最小二乘解法</font>
[线性代数的最小二乘](../Linear_Algebra/Lecture14_15_16.md)

## 最值的二阶验证

### 二阶导

$f(x,y)$的一阶偏导：
$$\frac{\partial f}{\partial x} = f_{x}$$ 
$$\frac{\partial f}{\partial y} = f_{y}$$

$f(x,y)$的二阶偏导：
$$\frac{\partial^2 f}{\partial x^2} = f_{xx}$$

$$\frac{\partial^2 f}{\partial x \partial y} = \frac{\partial^2 f}{\partial y \partial x} = f_{xy} = f_{yx}$$

$$\frac{\partial^2 f}{\partial y^2} = f_{yy}$$

### 最值类型判断

设$f(x,y)$有临界点$(x_0.y_0)$

设$A = f_{xx}$，$B = f_{xy}$，$C = f_{yy}$

1. $AC - B^2 > 0$ 且 $A > 0$为局部最小值点
2. $AC - B^2 > 0$ 且 $A < 0$为局部最大值点
3. $AC - B^2 < 0$为鞍点
4. $AC - B^2 = 0$为不确定

### 例：

有$f(x,y) = x + y + \frac{1}{xy}$($x,y>0$)

一阶偏导确定临界点:  
$f_x = 1 - \frac{1}{x^2y} = 0$  
$f_y = 1 - \frac{1}{xy^2} = 0$

解方程组得：$x = 1,y = 1$。即$(1,1)$处为$f(x,y)$的临界点

二阶偏导确定类型：  
$f_{xx} = \frac{2}{x^3y}$临界点为$A = 2$  
$f_{xy} = \frac{1}{x^2y^2}$临界点为$B = 1$  
$f_{yy} = \frac{2}{xy^3}$临界点为$C = 2$  


有$AC-B^2 = 4 - 1 = 3 > 0$，$A > 0$，故为临界点$(1,1)$局部最小值点